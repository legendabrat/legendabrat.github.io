<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Wheel</title>

<style>
body {
  margin:0;
  background:#111;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
  font-family:Arial;
}

.container {
  position:relative;
}

.wheel {
  width:400px;
  height:400px;
  border-radius:50%;
  border:10px solid #333;
  position:relative;
  transition: transform 5s cubic-bezier(.17,.67,.83,.67);
}

.arrow {
  position:absolute;
  left:-40px;
  top:50%;
  transform:translateY(-50%) rotate(180deg);
  width:0;
  height:0;
  border-top:15px solid transparent;
  border-bottom:15px solid transparent;
  border-right:30px solid white;
}

button {
  position:absolute;
  bottom:-70px;
  left:50%;
  transform:translateX(-50%);
  padding:10px 20px;
  font-size:18px;
  cursor:pointer;
}

@keyframes idleSpin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}
</style>
</head>
<body>

<div class="container">
  <div class="arrow"></div>
  <canvas id="wheelCanvas" class="wheel" width="400" height="400"></canvas>
  <button onclick="spin()">Крутить</button>
</div>

<!-- Звуки -->
<audio id="spinSound" src="https://www.soundjay.com/mechanical/sounds/spin-1.mp3"></audio>
<audio id="clickSound" src="https://www.soundjay.com/mechanical/sounds/click-1.mp3"></audio>
<audio id="applauseSound" src="https://www.soundjay.com/human/sounds/applause-8.mp3"></audio>

<script>
const canvas = document.getElementById("wheelCanvas");
const ctx = canvas.getContext("2d");

const segments = ["1", "2", "3", "4", "5", "6"];
const colors = ["#ff4d4d","#4dff4d","#4d4dff","#ffff4d","#ff4dff","#4dffff"];

const spinSound = document.getElementById("spinSound");
const clickSound = document.getElementById("clickSound");
const applauseSound = document.getElementById("applauseSound");

let angle = 0;
let spinning = false;

function drawWheel(){
  const arc = Math.PI * 2 / segments.length;

  for(let i=0;i<segments.length;i++){
    ctx.beginPath();
    ctx.fillStyle = colors[i];
    ctx.moveTo(200,200);
    ctx.arc(200,200,200, arc*i, arc*(i+1));
    ctx.fill();

    ctx.save();
    ctx.translate(200,200);
    ctx.rotate(arc*i + arc/2);
    ctx.fillStyle = "#000";
    ctx.font = "20px Arial";
    ctx.fillText(segments[i], 130,10);
    ctx.restore();
  }
}

drawWheel();

// Автокрутка при загрузке
canvas.style.animation = "idleSpin 20s linear infinite";

function spin(){
  if(spinning) return;

  spinning = true;
  canvas.style.animation = "none";

  spinSound.play();

  let spins = 5 + Math.random()*5;
  let finalAngle = spins * 360;

  angle += finalAngle;

  canvas.style.transform = `rotate(${angle}deg)`;

  // щелчки
  let clickInterval = setInterval(()=>{
    clickSound.currentTime = 0;
    clickSound.play();
  }, 150);

  setTimeout(()=>{
    clearInterval(clickInterval);
    spinSound.pause();
    applauseSound.play();
    spinning = false;

    canvas.style.animation = "idleSpin 20s linear infinite";

  },5000);
}
</script>

</body>
</html>
