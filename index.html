<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ö—Ä—É—Ç–∏–º –±–∞—Ä–∞–±–∞–Ω</title>

<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<style>
body{
  margin:0;
  background:#111;
  color:white;
  font-family:'Segoe UI', Tahoma, sans-serif;
  display:flex;
}

/* –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨ */
.sidebar{
  width:260px;
  background:rgba(255,255,255,0.05);
  padding:20px;
}

.sidebar h2{
  margin-top:0;
}

.nameInput{
  width:100%;
  padding:8px;
  margin-bottom:8px;
  background:rgba(255,255,255,0.1);
  border:none;
  color:white;
  font-size:14px;
  outline:none;
}

/* –û–°–ù–û–í–ù–ê–Ø –ß–ê–°–¢–¨ */
.main{
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}

h1{
  margin-bottom:20px;
  font-weight:500;
}

.container{
  position:relative;
}

.arrow{
  position:absolute;
  left:-40px;
  top:50%;
  transform:translateY(-50%) rotate(180deg);
  width:0;
  height:0;
  border-top:15px solid transparent;
  border-bottom:15px solid transparent;
  border-right:30px solid white;
}

canvas{
  border-radius:50%;
  border:8px solid #333;
}

/* –ü–õ–ê–®–ö–ê –ü–û–ë–ï–î–ò–¢–ï–õ–Ø */
#winnerBox{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%) scale(0.8);
  background:#1c1c1c;
  padding:70px 120px;
  border-radius:30px;
  text-align:center;
  box-shadow:0 30px 80px rgba(0,0,0,0.8);
  opacity:0;
  pointer-events:none;
  transition:0.4s ease;
}

#winnerBox.active{
  opacity:1;
  pointer-events:auto;
  transform:translate(-50%,-50%) scale(1);
}

#winnerTitle{
  font-size:28px;
  letter-spacing:2px;
  opacity:0.8;
}

#winnerName{
  font-size:56px;
  margin-top:20px;
  font-weight:700;
  font-family:'Trebuchet MS','Segoe UI',sans-serif;
  background:linear-gradient(90deg,#f1c40f,#e67e22);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
</style>
</head>
<body>

<div class="sidebar">
  <h2>–ò–º–µ–Ω–∞</h2>
  <input class="nameInput" id="n0" placeholder="–ò–≥—Ä–æ–∫ 1">
  <input class="nameInput" id="n1" placeholder="–ò–≥—Ä–æ–∫ 2">
  <input class="nameInput" id="n2" placeholder="–ò–≥—Ä–æ–∫ 3">
  <input class="nameInput" id="n3" placeholder="–ò–≥—Ä–æ–∫ 4">
  <input class="nameInput" id="n4" placeholder="–ò–≥—Ä–æ–∫ 5">
  <input class="nameInput" id="n5" placeholder="–ò–≥—Ä–æ–∫ 6">
  <input class="nameInput" id="n6" placeholder="–ò–≥—Ä–æ–∫ 7">
  <input class="nameInput" id="n7" placeholder="–ò–≥—Ä–æ–∫ 8">
</div>

<div class="main">
  <h1>üéØ –ö—Ä—É—Ç–∏–º –±–∞—Ä–∞–±–∞–Ω</h1>

  <div class="container">
    <div class="arrow"></div>
    <canvas id="wheel" width="420" height="420"></canvas>
  </div>

  <button style="margin-top:20px;padding:10px 25px;font-size:18px;border-radius:8px;border:none;cursor:pointer;" onclick="spin()">
    –ö—Ä—É—Ç–∏—Ç—å
  </button>
</div>

<!-- –ü–õ–ê–®–ö–ê -->
<div id="winnerBox">
  <div id="winnerTitle">–ü–û–ë–ï–î–ò–¢–ï–õ–¨</div>
  <div id="winnerName"></div>
  <br><br>
  <button onclick="closeWinner()" style="padding:10px 30px;font-size:16px;border:none;border-radius:8px;cursor:pointer;">
    –ó–∞–∫—Ä—ã—Ç—å
  </button>
</div>

<!-- –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<!-- –ê–ø–ª–æ–¥–∏—Å–º–µ–Ω—Ç—ã -->
<audio id="applause" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_115b9b1a75.mp3?filename=applause-2-6844.mp3"></audio>

<script>
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const winnerBox = document.getElementById("winnerBox");
const winnerNameEl = document.getElementById("winnerName");
const applause = document.getElementById("applause");

let angle = 0;
let spinning = false;

const colors = ["#e74c3c","#f1c40f","#3498db","#2ecc71"];

function getNames(){
  let arr=[];
  for(let i=0;i<8;i++){
    let val=document.getElementById("n"+i).value.trim();
    arr.push(val==="" ? "–ò–≥—Ä–æ–∫ "+(i+1) : val);
  }
  return arr;
}

function drawWheel(){
  const names = getNames();
  ctx.clearRect(0,0,420,420);
  const arc = 2*Math.PI / names.length;

  for(let i=0;i<names.length;i++){
    ctx.beginPath();
    ctx.moveTo(210,210);
    ctx.fillStyle = colors[i % colors.length];
    ctx.arc(210,210,210,arc*i+angle,arc*(i+1)+angle);
    ctx.fill();

    ctx.save();
    ctx.translate(210,210);
    ctx.rotate(arc*i + arc/2 + angle);
    ctx.fillStyle="white";
    ctx.font="18px 'Segoe UI'";
    ctx.textAlign="right";
    ctx.fillText(names[i],170,6);
    ctx.restore();
  }
}

function spin(){
  if(spinning) return;
  spinning=true;

  let velocity = 0.35 + Math.random()*0.25;

  function animate(){
    angle += velocity;
    velocity *= 0.985;
    drawWheel();

    if(velocity > 0.002){
      requestAnimationFrame(animate);
    } else {
      spinning=false;
      showWinner();
    }
  }

  animate();
}

function showWinner(){
  const names = getNames();
  const arc = 2*Math.PI / names.length;

  let pointerAngle = Math.PI; 
  let normalized = (angle + pointerAngle) % (Math.PI*2);
  let index = Math.floor((Math.PI*2 - normalized) / arc) % names.length;

  let winner = names[index];

  winnerNameEl.textContent = winner;
  winnerBox.classList.add("active");

  applause.currentTime = 0;
  applause.play();

  confetti({
    particleCount:180,
    spread:100,
    origin:{ y:0.6 }
  });
}

function closeWinner(){
  winnerBox.classList.remove("active");
}

document.querySelectorAll(".nameInput").forEach(input=>{
  input.addEventListener("input", drawWheel);
});

drawWheel();
</script>

</body>
</html>
